<div class="container">
  <div class="row">
    <div class="col-md-6">
      <h2>Your exercises in progress</h2>
        <div class="well">
          <% if dashboard.current_exercises.any? %>
            <p>Keep working on these problems, or archive them.</p>
            <ul class="nav nav-stacked" id="menu-current" role="menu">
              <% dashboard.current_exercises.limit(5).each do |exercise| %>
                <li class="looks-list-item">
                  <a role="menuitem" tabindex="-1" href="/exercises/<%= exercise.key %>">
                    <table width="100%">
                      <tr>
                        <td width="60%">
                          <%= exercise.problem.name + ' (' + exercise.problem.language %>)
                        </td>
                        <td width="25%">
                          <%= exercise.comment_count %> comments
                        </td>
                        <td width="15%">
                          iterations <%= exercise.iteration_count %>
                        </td>
                      </tr>
                    </table>
                  </a>
                </li>
              <% end %>
              <% if dashboard.current_exercises.length > 5 %>
                <p>You have <%= dashboard.current_exercises.length %> active problems - <a href="/<%= user.username %>">see all</a></p>
              <% end %>
            </ul>
          <% else %>
            <p>You are not currently working on any exercises.</p>
          <% end %>
          <% if dashboard.unsubmitted_exercises.present? %>
            <p>You've fetched these problems. Now solve them!</p>
            <ul class="nav nav-stacked" id="menu-current" role="menu">
              <% dashboard.unsubmitted_exercises.limit(5).each do |exercise| %>
                <li class="looks-list-item">
                  <a role="menuitem"
                     tabindex="-1"
                     href=<%= "/exercises/#{exercise.language}/#{exercise.slug}/readme" %>>
                    <table width="100%">
                      <tr>
                        <td width="60%">
                          <%= "#{exercise.problem.name} (#{exercise.problem.language})" %>
                        </td>
                      </tr>
                    </table>
                  </a>
                </li>
              <% end %>
              <% if dashboard.unsubmitted_exercises.size > 5 %>
                <p>You have <%= dashboard.unsubmitted_exercises.size %> unsubmitted problems.</p>
              <% end %>
            </ul>
          <% else %>
            <p>You do not have any unsubmitted problems.</p>
          <% end %>
        </div>
    </div>

    <div class="col-md-6">
      <h2>Notifications</h2>
        <div class="well">
          <% if dashboard.has_activity? %>
            <% dashboard.notifications.each do |notification| %>
              <% if notification.item %>
                <li style="list-style-type: none; margin: 0;">
                  <span style="padding-right: 5px;" class="icon-comment-alt"></span>
                  <a href="/<%= notification.creator.username %>"><%= notification.creator.username %></a> on <a href="/submissions/<%= notification.item.key %>">
                    <%= notification.submission.name %> (<%= notification.language.capitalize %>)
                  </a>
                </li>
              <% end %>
            <% end %>
          <% else %>
            <p>No unread notifications.</p>
          <% end %>
        </div>
    </div>
  </div>

  <% if (current_user.teams | current_user.managed_teams).any? %>
    <div class="row">
      <div class="col-sm-4">
        <h2>Your Teams</h2>
        <div class="well">
          <ul class="nav nav-stacked">
            <% (current_user.teams | current_user.managed_teams).each do |team| %>
              <li>
                <a role="menuiytem" tabindex="-1" href="/teams/<%= team.slug %>">
                  <table width="100%">
                    <tr>
                      <td width="60%">
                        <%= team.name %>
                      </td>
                      <td width="40%">
                        <%= team.confirmed_members.size %> members
                      </td>
                    </tr>
                  </table>
                </a>
              </li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
  <% end %>

  <div class="row">
    <div class="col-sm-4">
      <h2>Trending</h2>
        <div class="well">
          <% if dashboard.trending.any? %>
            <ul class="nav nav-stacked" id="menu-current" role="menu">
              <% dashboard.trending.each do |trending| %>
              <li class="looks-list-item">
                <p><a role="menuitem" tabindex="-1" href="/submissions/<%= trending.uuid %>">
                  <%= trending.name + ' (' + trending.language + ') ' %></a>by <a href="/<%= trending.username %>"><%= trending.username %></a></p>
              </li>
              <% end %>
            </ul>
          <% else %>
            <p>No exercises currently trending.</p>
          <% end %>
        </div>
    </div>

    <div class="col-sm-4">
      <h2>Recently viewed</h2>
        <div class="well">
          <% if recently_viewed_exercises.any? %>
            <ul class="nav nav-stacked" id="menu-current" role="menu">
              <% recently_viewed_exercises.each do |exercise| %>
              <li class="looks-list-item">
                <p><a role="menuitem" tabindex="-1" href="/exercises/<%= exercise.key %>">
                  <%= exercise.problem.name + ' (' + exercise.problem.language + ') ' %></a>by <a href="/<%= exercise.user.username %>"><%= exercise.user.username %></a></p>
              </li>
              <% end %>
            </ul>
            <% if recently_viewed_more %>
              <p>... <a href="/looks">see all</a></p>
            <% end %>
          <% else %>
            <p>No exercises viewed in the past 30 days.</p>
          <% end %>
        </div>
    </div>

    <div class="col-md-4">
      <h2>Need help?</h2>
      <p>The <a href="/help">help page</a> should get you going.</p>
    </div>
  </div>
</div>
